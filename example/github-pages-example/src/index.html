<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="CodeMirror 6 LaTeX Visual Editor with MathLive">
  <title>CodeMirror 6 LaTeX Visual Editor</title>
</head>
<body>
  <header>
    <h1>CodeMirror LaTeX Visual Editor</h1>
    <p>Visual editing for LaTeX documents with interactive math editing</p>
    <div class="links">
      <a href="https://github.com/texlyre/codemirror-latex-visual" target="_blank" rel="noopener noreferrer">GitHub</a>
      <a href="https://www.npmjs.com/package/codemirror-latex-visual" target="_blank" rel="noopener noreferrer">npm</a>
    </div>
  </header>

  <main>
    <section class="demo-container">
      <h2>Side-by-Side Demo</h2>
      <p>See how the single CodeMirror editor renders LaTeX with visual overlays. The left editor shows raw LaTeX source, while the right shows the same content with visual overlays for sections, math, and commands.</p>
      <div class="editors-grid">
        <div class="editor-panel">
          <h3>CodeMirror (Source)</h3>
          <div id="codemirror-editor"></div>
        </div>
        <div class="editor-panel">
          <h3>CodeMirror (Visual Overlays)</h3>
          <div id="prosemirror-editor"></div>
        </div>
      </div>

      <div class="single-editor-demo">
        <h2>Single Editor with Mode Toggle</h2>
        <p>Toggle between source and visual editing modes on the same editor. Press <kbd>Ctrl+E</kbd> to switch modes. In visual mode, LaTeX elements are replaced with visual widgets. Press <kbd>Ctrl+Shift+C</kbd> to toggle command visibility. Click any math equation to edit it with MathLive.</p>
        <div id="dual-editor"></div>
      </div>
    </section>

    <section class="features">
      <h2>Single Editor Architecture Features</h2>
      <ul>
        <li><strong>Single CodeMirror Editor:</strong> Uses one editor with visual overlays that can be toggled on/off</li>
        <li><strong>No Synchronization:</strong> Visual widgets are overlays on the same document - no sync needed</li>
        <li><strong>Interactive Math:</strong> Click math equations to edit with MathLive's interface</li>
        <li><strong>Visual Widgets:</strong> Sections, environments, tables, and commands rendered as visual overlays</li>
        <li><strong>Command Toggle:</strong> Show/hide LaTeX commands in visual mode (Ctrl+Shift+C)</li>
        <li><strong>Direct Editing:</strong> All changes update the source document directly</li>
        <li><strong>Better Performance:</strong> No document conversion or dual editor overhead</li>
        <li><strong>Clean Architecture:</strong> Visual mode is simply an overlay state on the same editor</li>
      </ul>
    </section>

    <section class="usage">
      <h2>Updated Usage</h2>
      <pre><code>import { EditorState, EditorView } from '@codemirror/state';
import { DualLatexEditor, VisualCodeMirrorEditor } from 'codemirror-latex-visual';
import 'codemirror-latex-visual/dist/styles.css';

// Create your CodeMirror editor
const cmEditor = new EditorView({
  state: EditorState.create({
    doc: '\\section{Title}\nSome text with $x^2$ inline math.',
    extensions: [/* your extensions */]
  }),
  parent: document.getElementById('cm-container')
});

// Option 1: Dual editor with mode switching
const dualEditor = new DualLatexEditor(
  document.getElementById('editor-wrapper'),
  cmEditor,
  {
    initialMode: 'source',
    showCommands: false,
    onModeChange: (mode) => console.log('Switched to:', mode)
  }
);

// Option 2: Direct visual overlay control
const visualEditor = new VisualCodeMirrorEditor(cmEditor, {
  showCommands: false
});
visualEditor.setVisualMode(true); // Enable overlays
visualEditor.setVisualMode(false); // Disable overlays</code></pre>
    </section>
  </main>

  <footer>
    <p>MIT License &copy; 2025 <a href="https://abawi.me">Fares Abawi</a></p>
  </footer>
</body>
</html>