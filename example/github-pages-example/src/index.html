<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="CodeMirror 6 LaTeX Visual Editor with MathLive">
  <title>CodeMirror 6 LaTeX Visual Editor</title>
</head>
<body>
  <header>
    <h1>CodeMirror LaTeX Visual Editor</h1>
    <p>Visual editing for LaTeX documents with interactive math editing</p>
    <div class="links">
      <a href="https://github.com/texlyre/codemirror-latex-visual" target="_blank" rel="noopener noreferrer">GitHub</a>
      <a href="https://www.npmjs.com/package/codemirror-latex-visual" target="_blank" rel="noopener noreferrer">npm</a>
    </div>
  </header>

  <main>
    <section class="demo-container">
      <h2>Side-by-Side Demo</h2>
      <p>See how the new CodeMirror-based visual editor renders LaTeX with overlay widgets. The left editor shows raw LaTeX source, while the right shows the same content with visual overlays for sections, math, and commands.</p>
      <div class="editors-grid">
        <div class="editor-panel">
          <h3>CodeMirror (Source)</h3>
          <div id="codemirror-editor"></div>
        </div>
        <div class="editor-panel">
          <h3>CodeMirror (Visual Overlays)</h3>
          <div id="prosemirror-editor"></div>
        </div>
      </div>

      <div class="single-editor-demo">
        <h2>Integrated Dual Editor</h2>
        <p>Toggle between source and visual editing modes. Press <kbd>Ctrl+E</kbd> to switch modes. In visual mode, LaTeX elements are replaced with visual widgets. Press <kbd>Ctrl+Shift+C</kbd> to toggle command visibility. Click any math equation to edit it with MathLive.</p>
        <div id="dual-editor"></div>
      </div>
    </section>

    <section class="features">
      <h2>New Architecture Features</h2>
      <ul>
        <li><strong>Single Editor:</strong> Uses CodeMirror with visual overlays instead of dual editors</li>
        <li><strong>Perfect Sync:</strong> No synchronization needed - visual widgets correspond exactly to source positions</li>
        <li><strong>Interactive Math:</strong> Click math equations to edit with MathLive's interface</li>
        <li><strong>Visual Widgets:</strong> Sections, environments, tables, and commands rendered as visual overlays</li>
        <li><strong>Command Toggle:</strong> Show/hide LaTeX commands in visual mode (Ctrl+Shift+C)</li>
        <li><strong>Direct Editing:</strong> All changes update the source document directly</li>
        <li><strong>Better Performance:</strong> No document conversion overhead</li>
        <li><strong>Extensible:</strong> Easy to add new widget types for custom LaTeX constructs</li>
      </ul>
    </section>

    <section class="installation">
      <h2>Installation</h2>
      <pre><code>npm install codemirror-latex-visual</code></pre>
    </section>

    <section class="usage">
      <h2>Updated Usage</h2>
      <pre><code>import { EditorState, EditorView } from '@codemirror/state';
import { DualLatexEditor, VisualCodeMirrorEditor } from 'codemirror-latex-visual';
import 'codemirror-latex-visual/dist/styles.css';

// Create your CodeMirror editor
const cmEditor = new EditorView({
  state: EditorState.create({
    doc: '\\section{Title}\nSome text with $x^2$ inline math.',
    extensions: [/* your extensions */]
  }),
  parent: document.getElementById('cm-container')
});

// Option 1: Dual editor with mode switching
const dualEditor = new DualLatexEditor(
  document.getElementById('editor-wrapper'),
  cmEditor,
  {
    initialMode: 'source',
    showCommands: false,
    onModeChange: (mode) => console.log('Switched to:', mode)
  }
);

// Option 2: Always-visual editor
const visualEditor = new VisualCodeMirrorEditor(cmEditor, {
  showCommands: false
});
visualEditor.setVisualMode(true);</code></pre>
    </section>

    <section class="api">
      <h2>Updated API Reference</h2>
      <h3>DualLatexEditor</h3>
      <pre><code>const dualEditor = new DualLatexEditor(container, cmEditor, options);

// Methods
dualEditor.setMode('visual');           // Switch to visual mode
dualEditor.setMode('source');           // Switch to source mode
dualEditor.toggleMode();                // Toggle between modes
dualEditor.toggleCommandVisibility();   // Toggle LaTeX command display
dualEditor.toggleToolbar();             // Toggle toolbar display
dualEditor.destroy();                   // Clean up resources

// Options
{
  initialMode: 'source' | 'visual',      // Default: 'source'
  onModeChange: (mode) => void,          // Mode change callback
  showCommands: boolean,                 // Show LaTeX commands in visual mode
  showToolbar: boolean,                  // Show formatting toolbar
  className: string                      // Additional CSS class
}</code></pre>

      <h3>VisualCodeMirrorEditor</h3>
      <pre><code>const visualEditor = new VisualCodeMirrorEditor(cmEditor, options);

// Methods
visualEditor.setVisualMode(true);       // Enable visual overlays
visualEditor.setVisualMode(false);      // Disable visual overlays
visualEditor.toggleMode();              // Toggle visual mode
visualEditor.destroy();                 // Clean up

// Options
{
  showCommands: boolean,                 // Show LaTeX commands
  onModeChange: (mode) => void          // Mode change callback
}</code></pre>
    </section>
  </main>

  <footer>
    <p>MIT License &copy; 2025 <a href="https://abawi.me">Fares Abawi</a></p>
  </footer>
</body>
</html>